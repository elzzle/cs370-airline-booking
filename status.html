<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="styles.css">
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-database.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-storage.js"></script>
        <script src="backend/fb.js"></script>

        <title>Book flights with AirBook</title>
        <nav class="navbar navbar-light" style="background-color: #14277e;">
            <a class="navbar-brand" href="index.html">
                <img class="logo" src="images/logo.svg" alt="AirBook SVG" width="80" height="80" onerror="this.removeAttribute('onerror'); this.src='images/logo.svg'" />
            </a>
            <div class="logsign-container">
                <a id="loginBtn" class="btn btn-danger" href="login.html">Login</a>
                <a id="signupBtn" class="btn btn-danger" href="signup.html">Sign Up</a>
                <button id="logoutBtn" class="btn btn-danger" onclick="logOutUser()">Log out</button>
            </div>
        </nav>
        
    </head>

    <body>
        <script>
            //logs user out
            function logOutUser(){
                firebase.auth().signOut();
                window.location.href="index.html"
            }
            //checks if user is logged in and diplays the buttons on the nav accordingly
            firebase.auth().onAuthStateChanged(function(user){
                if(user){
                    document.getElementById('loginBtn').style.display='none';
                    document.getElementById('signupBtn').style.display='none';
                    document.getElementById('logoutBtn').style.display='block';
                }
                else {
                    document.getElementById('loginBtn').style.display='inline';
                    document.getElementById('signupBtn').style.display='inline';
                    document.getElementById('logoutBtn').style.display='none';
                }
            });

            const statusBody = document.querySelector("#status-table > tbody");
            // console.log(statusBody);

            function loadStatus() {
                const request = new XMLHttpRequest();
                request.open("get", "flights.json");
                request.onload = () => {
                    try {

                    const json = JSON.parse(request.responseText);
                    populateStatus(json);
                    } catch (e) {
                        console.warn("Could not load Status");
                    }
                }
                request.send();
            }
            function populateStatus(json) {
                // console.log(json)
                // Clears out existing table data
                // while (statusBody.firstChild) {
                //     statusBody.removeChild(statusBody.firstChild);
                // }
                for(var i=0; i<json.flights.length; i++){
                    // console.log(json.flights[i]);
                    const tr = document.createElement("tr");

                }

                statusBody.appendChild(tr);
                // Populate Table
                // json.forEach((row) => {
                //     console.log(row)
                // })
            }

            document.addEventListener("DOMContentLoaded", () => {loadStatus(); });

        </script>

        <table id="status-table" class="table">
            <thead>
                <tr>
                    <th>Time</th>
                    <th>Destination</th>
                    <th>Gate</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>

                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>

            </tbody>
        </table>
    </body>
</html>